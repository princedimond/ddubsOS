# WARP.md

Operational guidance for Warp AI when working in this repository.

Essentials

- Project type: NixOS flake repository.
- Home Manager: there is no standalone Home Manager deployment here. Home Manager is imported as a NixOS module and configured via system rebuilds. Do not propose or ask to run `home-manager switch`; use the NixOS rebuild flow.
- Overlays and packages: external flake inputs must be surfaced via overlays and consumed through `pkgs` only. See `modules/core/overlays.nix` which exposes:
  - `pkgs.hyprpanel`
  - `pkgs.ags`
  - `pkgs.wfetch`
  Future additions (e.g., quickshell) should follow the same pattern: add to the overlay, then consume as `pkgs.<name>` in modules.

Rebuild workflow guardrails

- Prefer zcli for builds and updates:
  - `zcli rebuild` (default)
  - `zcli rebuild-boot` (activate on next reboot)
  - `zcli update` (flake update + rebuild)
- If you must use nixos-rebuild directly, reference the GPU profile, not the hostname:
  - `nixos-rebuild switch --flake .#<profile>` where `<profile>` is one of: `amd`, `intel`, `nvidia`, `nvidia-laptop`, `vm`.
  - Determine the current profile from flake.nix (let-bound `profile`) or the zcli host settings; do not use .#<hostname>.
- When adding new files that Nix will import (e.g., under `modules/`, `hosts/`, `profiles/`, or other files referenced by the flake), stage them before rebuilding:
  - `git add <file>` or `git add -A` (recommended if multiple files were created)
- Rationale: untracked files referenced by the flake or a module can cause evaluation failures. Staging first keeps the working tree consistent for Nix evaluation in this repo.

Avoid repetitive questions

- Do not ask whether Home Manager is standalone: it is imported as a module in the NixOS configuration.
- When you need to know the current host/profile, read them from `flake.nix` and `hosts/<host>/variables.nix`. Only prompt if the information is genuinely missing.

References

- docs/project-guide.md (English)
- docs/project-guide.es.md (Espa√±ol)
- CHANGELOG.ddubs.md

